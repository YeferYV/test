# stages:          # List of stages for jobs, and their order of execution
#   - release
#
# release_job:
#   stage: release
#   image: registry.gitlab.com/gitlab-org/release-cli:latest
#   script:
#     - echo "running release_job"
#     - mkdir bin && echo "this is a release" > bin/binary
#   artifacts:
#     paths:
#       - bin
#   release:                               # See https://docs.gitlab.com/ee/ci/yaml/#release for available properties
#     tag_name: '$CI_COMMIT_TAG'
#     description: '$CI_COMMIT_TAG'
#     assets:
#       links:
#         - name: '${CI_COMMIT_TAG}'
#           url: "${CI_PROJECT_URL}"
#           filepath: 'bin/'
#           link_type: 'other' # optional

release:
  stage: release
  image: registry.gitlab.com/gitlab-org/release-cli:latest
  variables:
    LINUX_ASSET_LINK: "{\"name\":\"${CI_COMMIT_TAG}\",\"url\":\"${CI_PROJECT_URL}\",\"type\":\"package\"}"
  script:
    - |
      release-cli create --name "Release ${CI_COMMIT_TAG}" \
        --tag-name "${CI_COMMIT_TAG}" \
        --assets-link "${LINUX_ASSET_LINK}" \
        --upload-dir "bin/"
